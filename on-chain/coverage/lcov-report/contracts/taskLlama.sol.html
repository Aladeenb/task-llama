<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/taskLlama.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> taskLlama.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">63.79% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>37/58</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">44.74% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>17/38</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">61.54% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>8/13</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">51.14% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>45/88</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
/*
    TODO:
      - add description
      - add comments
      - use "Agent" smart-contract from Galadriel
      - test coverage
      - agent owners are the ones responsible for completing the tasks, not agents
      - for Galadriel, agent address should be the oracleAddress
      - for Galadriel, how to query the agent owner?
      - performance testing
      - who can verify tasks?
      - when creating a task, the creator should deposit the reward in the contract
      - add functions to query from the categoryt tasks table
      - category task should not include tasks as it can be gas expensive, can however include the task ids?
      - create excalidraw diagram explaining the contract lifecycle
      - Sort functions based on type and alphabetical order
      - Reduce redundancy in the code by creating helper functions
*/
pragma solidity ^0.8.24;
&nbsp;
contract TaskLlama {
  enum Category {
    Administrative,
    CustomerService,
    DataAnalysis,
    HumanResources,
    Marketing,
    Sales,
    Finance,
    ITandSecurity,
    Operations,
    ResearchandDevelopment,
    Legal,
    Healthcare,
    Education,
    ContentCreation,
    EnvironmentalManagement
  }
&nbsp;
  struct Task {
    uint256 id;
    string description;
    uint256 reward;
    string[] testCases;
    uint256 expiry;
    address creator;
    address assignedAgent;
    bool completed;
    bool verified;
    Category category;
  }
&nbsp;
  struct Agent {
    address agentAddress;
    address ownerAddress;
    mapping(Category =&gt; Task[]) categoryTasks; // Use mapping for tasks by category
  }
&nbsp;
  Task[] public tasks;
  mapping(address =&gt; Agent) public agents;
  address[] public agentAddresses;
&nbsp;
  event TaskCreated(
    uint256 taskId,
    string description,
    uint256 reward,
    uint256 expiry,
    Category category
  );
  event AgentRegistered(address agent);
  event AgentAssigned(uint256 taskId, address agent);
  event TaskCompleted(uint256 taskId, address agent, uint256 reward);
  event TaskVerified(uint256 taskId, address verifier);
&nbsp;
  function createTask(
    string memory _description,
    uint256 _reward,
    string[] memory _testCases,
    uint256 _expiry,
    Category _category
  ) public payable {
    <span class="missing-if-branch" title="else path not taken" >E</span>require(msg.value == _reward, 'Incorrect reward amount sent');
&nbsp;
    Task memory newTask = Task({
      id: tasks.length,
      description: _description,
      reward: _reward,
      testCases: _testCases,
      expiry: _expiry,
      creator: msg.sender,
      assignedAgent: address(0),
      completed: false,
      verified: false,
      category: _category
    });
&nbsp;
    tasks.push(newTask);
    emit TaskCreated(
      newTask.id,
      newTask.description,
      newTask.reward,
      newTask.expiry,
      newTask.category
    );
  }
&nbsp;
  function registerAgent(address _agentAddress) public {
    <span class="missing-if-branch" title="else path not taken" >E</span>require(
      agents[_agentAddress].agentAddress == address(0),
      'Agent already registered'
    );
&nbsp;
    Agent storage newAgent = agents[_agentAddress];
    newAgent.agentAddress = _agentAddress;
    newAgent.ownerAddress = msg.sender;
    agentAddresses.push(_agentAddress);
    emit AgentRegistered(_agentAddress);
  }
&nbsp;
  function assignAgent(uint _taskId, address _agent) public {
    Task storage task = tasks[_taskId];
    <span class="missing-if-branch" title="else path not taken" >E</span>require(task.expiry &gt; block.timestamp, 'Task expired');
    <span class="missing-if-branch" title="else path not taken" >E</span>require(task.creator == msg.sender, 'Only the creator can assign an agent');
    <span class="missing-if-branch" title="else path not taken" >E</span>require(task.assignedAgent == address(0), 'Task already assigned');
    <span class="missing-if-branch" title="else path not taken" >E</span>require(agents[_agent].agentAddress != address(0), 'Agent not registered');
&nbsp;
    task.assignedAgent = _agent;
    agents[_agent].categoryTasks[task.category].push(task);
&nbsp;
    emit AgentAssigned(_taskId, _agent);
  }
&nbsp;
  function completeTask(address agentAddress, uint256 _taskId) public {
    <span class="missing-if-branch" title="else path not taken" >E</span>require(_taskId &lt; tasks.length, 'Task does not exist');
    Task storage task = tasks[_taskId];
    require(
      task.assignedAgent == agentAddress,
      'Only the assigned agent can complete the task'
    );
    <span class="missing-if-branch" title="else path not taken" >E</span>require(!task.completed, 'Task already completed');
    <span class="missing-if-branch" title="else path not taken" >E</span>require(<span class="branch-0 cbranch-no" title="branch not covered" >task.expiry == 0</span> || block.timestamp &lt; task.expiry, 'Task expired');
&nbsp;
    task.completed = true;
&nbsp;
    emit TaskCompleted(_taskId, agentAddress, task.reward);
  }
&nbsp;
  function verifyTask(uint256 _taskId) public {
    <span class="missing-if-branch" title="else path not taken" >E</span>require(_taskId &lt; tasks.length, 'Task does not exist');
    Task storage task = tasks[_taskId];
    <span class="missing-if-branch" title="else path not taken" >E</span>require(
      task.creator == msg.sender,
      'Only the task creator can verify the task'
    );
    <span class="missing-if-branch" title="else path not taken" >E</span>require(task.completed, 'Task not completed yet');
    <span class="missing-if-branch" title="else path not taken" >E</span>require(!task.verified, 'Task already verified');
&nbsp;
    task.verified = true;
&nbsp;
    payable(getAgentOwner(task.assignedAgent)).transfer(task.reward);
    emit TaskVerified(_taskId, msg.sender);
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getAgentTasksByCategory(</span>
    address _agent,
    Category _category
  ) public view returns (Task[] memory) {
<span class="cstat-no" title="statement not covered" >    return agents[_agent].categoryTasks[_category];</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getLeaderboard(Category _category) public view returns (address[] memory) {</span>
<span class="cstat-no" title="statement not covered" >    address[] memory leaderboard = new address[](agentAddresses.length);</span>
<span class="cstat-no" title="statement not covered" >    uint256[] memory completedTasks = new uint256[](agentAddresses.length);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint256 i = 0; i &lt; agentAddresses.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      Agent storage agent = agents[agentAddresses[i]];</span>
<span class="cstat-no" title="statement not covered" >      Task[] storage agentTasks = agent.categoryTasks[_category];</span>
<span class="cstat-no" title="statement not covered" >      uint256 completedTask = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      for (uint256 j = 0; j &lt; agentTasks.length; j++) {</span>
<span class="cstat-no" title="statement not covered" >        if (agentTasks[j].verified) {</span>
          completedTask += agentTasks[j].reward;
        }
      }
&nbsp;
      completedTasks[i] = completedTask;
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint256 i = 0; i &lt; completedTasks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      uint256 maxcompletedTask = 0;</span>
<span class="cstat-no" title="statement not covered" >      uint256 maxIndex = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      for (uint256 j = 0; j &lt; completedTasks.length; j++) {</span>
<span class="cstat-no" title="statement not covered" >        if (completedTasks[j] &gt; maxcompletedTask) {</span>
          maxcompletedTask = completedTasks[j];
          maxIndex = j;
        }
      }
&nbsp;
      leaderboard[i] = agentAddresses[maxIndex];
      completedTasks[maxIndex] = 0;
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return leaderboard;</span>
  }
&nbsp;
  function getTasks() public view returns (Task[] memory) {
    return tasks;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getCategories() public pure returns (Category[] memory) {</span>
<span class="cstat-no" title="statement not covered" >    Category[] memory categories = new Category[](15);</span>
    categories[0] = Category.Administrative;
    categories[1] = Category.CustomerService;
    categories[2] = Category.DataAnalysis;
    categories[3] = Category.HumanResources;
    categories[4] = Category.Marketing;
    categories[5] = Category.Sales;
    categories[6] = Category.Finance;
    categories[7] = Category.ITandSecurity;
    categories[8] = Category.Operations;
    categories[9] = Category.ResearchandDevelopment;
    categories[10] = Category.Legal;
    categories[11] = Category.Healthcare;
    categories[12] = Category.Education;
    categories[13] = Category.ContentCreation;
    categories[14] = Category.EnvironmentalManagement;
&nbsp;
<span class="cstat-no" title="statement not covered" >    return categories;</span>
  }
&nbsp;
  function getAgentCompletedTasks(
    address _agent
  ) public view returns (Task[] memory) {
    Task[] memory completedTasks = new Task[](tasks.length);
    uint256 completedTasksCount = 0;
&nbsp;
    for (uint256 i = 0; i &lt; tasks.length; i++) {
      <span class="missing-if-branch" title="else path not taken" >E</span>if (tasks[i].assignedAgent == _agent &amp;&amp; tasks[i].completed) {
        completedTasks[completedTasksCount] = tasks[i];
        completedTasksCount++;
      }
    }
&nbsp;
    Task[] memory resizedCompletedTasks = new Task[](completedTasksCount);
    for (uint256 i = 0; i &lt; completedTasksCount; i++) {
      resizedCompletedTasks[i] = completedTasks[i];
    }
&nbsp;
    return resizedCompletedTasks;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getAgentCompletedTasksCount(</span>
    address _agent
  ) public view returns (uint256) {
<span class="cstat-no" title="statement not covered" >    uint256 completedTasksCount = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint256 i = 0; i &lt; tasks.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      if (tasks[i].assignedAgent == _agent &amp;&amp; tasks[i].completed) {</span>
        completedTasksCount++;
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return completedTasksCount;</span>
  }
&nbsp;
  function getAgentOwner(address _agent) public view returns (address) {
    return agents[_agent].ownerAddress;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function depositFunds() public payable {</span>
    // The contract automatically receives the funds
  }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Jul 06 2024 02:40:01 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
